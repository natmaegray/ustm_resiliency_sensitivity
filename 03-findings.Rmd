# Findings

The HBW results for the standard deviation are included in \@ref(fig:stats100) and \@ref(fig:stats600). The results for the other two purposes (HBO and NHB) are in \@ref(fig:hbostats) and \@ref(fig:nhbstats).

```{r stats100, warning = FALSE, echo = FALSE, message = FALSE, fig.align="center", out.width = "75%", results='asis', fig.cap = "HBW Mean Logsum Standard Variation with 100 Draws"}
tar_load(hbw_stats_100)

hbw_stats_100 %>%
  filter(type != "base") %>%
  ggplot() +
    aes(x = draw, y = cumvar, colour = type, group = type) +
    geom_line(size = 0.5) +
    ylim(0, 0.14) +
    labs(x = "Draw", 
         y = "Cumulative Standard Variation",
         color = "method") +
    scale_color_hue(direction = 1) +
    theme_bw() +
    theme(legend.position = "bottom")
```

```{r stats600, warning = FALSE, echo = FALSE, message = FALSE, fig.align="center", out.width = "75%", results='asis', fig.cap = "HBW Mean Logsum Standard Variation with 600 Draws"}
tar_load(hbw_stats_600)

hbw_stats_600 %>%
  filter(type != "base") %>%
  ggplot() +
    aes(x = draw, y = cumvar, colour = type, group = type) +
    geom_line(size = 0.5) +
  ylim(0, 0.14) +
    labs(x = "Draw", 
         y = "Cumulative Standard Variation",
         color = "method") +
    scale_color_hue(direction = 1) +
    theme_bw() +
    theme(legend.position = "bottom")
```

```{r hbostats, warning = FALSE, echo = FALSE, message = FALSE, fig.align="center", out.width = "75%", results='asis', fig.cap = "HBO Mean Logsum Standard Variation with 100 and 600 Draws"}
tar_load(hbo_stats_100)
tar_load(hbo_stats_600)
hbo_stats <- bind_rows(hbo_stats_100, hbo_stats_600, .id = "ndraws") %>%
  mutate(ndraws = case_when(ndraws == "1" ~ "100 Draws",
                          ndraws == "2" ~ "600 Draws"))

hbo_stats %>%
  filter(type != "base") %>%
  ggplot() +
    aes(x = draw, y = cumvar, colour = type, group = type) +
    geom_line(size = 0.5) +
    ylim(0.025, 0.15) +
    labs(x = "Draw", 
         y = "Cumulative Standard Variation",
         color = "method") +
    scale_color_hue(direction = 1) +
    theme_bw() +
    theme(legend.position = "bottom") +
    facet_wrap(vars(ndraws), scales = "free_x")
```

```{r nhbstats, warning = FALSE, echo = FALSE, message = FALSE, fig.align="center", out.width = "75%", results='asis', fig.cap = "NHB Mean Logsum Standard Variation with 100 and 600 Draws"}
tar_load(nhb_stats_100)
tar_load(nhb_stats_600)
nhb_stats <- bind_rows(nhb_stats_100, nhb_stats_600, .id = "ndraws") %>%
  mutate(ndraws = case_when(ndraws == "1" ~ "100 Draws",
                          ndraws == "2" ~ "600 Draws"))

nhb_stats %>%
  filter(type != "base") %>%
  ggplot() +
    aes(x = draw, y = cumvar, colour = type, group = type) +
    geom_line(size = 0.5) +
    ylim(0.025, 0.15) +
    labs(x = "Draw", 
         y = "Cumulative Standard Variation",
         color = "method") +
    scale_color_hue(direction = 1) +
    theme_bw() +
    theme(legend.position = "bottom") +
    facet_wrap(vars(ndraws), scales = "free_x")

```

These figures show that LHS variation stabilized at a sooner number of draws than MC sampling does. In all six instances, LHS plateaued between 100 and 200 draws, where MC samples still had not stabilized at the same extent after 600 draws. With these results, LHS will be used and modified for a full-scale model using 150 draws of LHS input parameters.